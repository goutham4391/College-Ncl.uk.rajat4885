"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var displayCourses=function(){var e=document.querySelector(".undergraduateCourseSearch")?"undergraduate":"postgraduate",s={displayCourseData:function(){var a={collection:"neu-web-courses",meta_stencilsCourseType_sand:e,num_ranks:"500"};$.ajax({url:"//search.ncl.ac.uk/s/search.json",type:"GET",data:a,dataType:"jsonp"}).done(function(e){$(".courseSearchResults__alphabet-list").show(),$(".courseSearchResults__courseList").show(),$(".initialList").hide(),document.querySelector(".undergraduateCourseSearch")&&(s.browseUgCourses(e.response.resultPacket.results),s.displayCourseSort(e.response.resultPacket.results)),document.querySelector(".postgraduateCourseSearch")&&(s.browsePgCourses(e.response.resultPacket.results),s.displayCourseSort(e.response.resultPacket.results))}).fail(function(){simplfiedSearch()})},browsePgCourses:function(e){var a={},t=[];$(".dropDownBlock").each(function(){var e=$(this);t.push(e.data("subjectArea"))}),t.forEach(function(s){var t=[];e.forEach(function(e){var a=e.metaData.stencilsCourseSubject,r=[],o=[];if(void 0!==a&&(r=a.split(",")),$.each(r,function(e,s){return o.push(s)}),-1!==o.indexOf(s))return t.push(e)}),a[s]=t}),s.populatePgBrowseList(a)},populatePgBrowseList:function(e){for(var s in e){var a=e[s].sort(function(e,s){return e.metaData.stencilsCourseTitle<s.metaData.stencilsCourseTitle?-1:e.metaData.stencilsCourseTitle>s.metaData.stencilsCourseTitle?1:0}),t=_.groupBy(a,"metaData.stencilsCourseSubject");for(var r in t)for(var o in t[r]){var c=t[r][o].metaData.stencilsCourseTitle,n="https://search.ncl.ac.uk"+t[r][o].clickTrackingUrl,i=void 0!==t[r][o].metaData.stencilsCourseMode?t[r][o].metaData.stencilsCourseMode:"",u=t[r][o].metaData.stencilsCourseDesc;$('.dropDownBlock[data-subject-area="'.concat(s,'"]')).find(".dropDownSummary ul").append('<li><a href="Javascript:void(0);" class="dropDownHeading courseDropdown courseTitle">'.concat(c,'\n                  <span class="toggle"></span></a>\n                  <div class="courseExtra">\n                      <div class="courseExtraBox">\n                          <div class="courseExtraBox__left">\n                              <div class="courseBrief">\n                                  <span class="courseYear">').concat(i,"</span>\n                                  <p>").concat(u,'</p>\n                                  <div class="courseInfo">\n                                      <a href="').concat(n,'" class="cta">View full course information</a>\n                                  </div>\n                              </div>\n                          </div>\n                      </div>\n                  </div>\n                  </li>'))}}$(".courseTitle").click(function(){$(this).toggleClass("dropdownOpen"),$(this).is(".dropdownOpen")?$(this).next().slideDown():$(this).next().slideUp()})},browseUgCourses:function(s){var a=[],t={},r=$(".dropDownBlock");for(var o in r.each(function(){var e=$(this);a.push(e.data("subjectArea"))}),a.forEach(function(e){var a=[];s.forEach(function(s){var t=s.metaData.keywords,r=[],o=[];if(void 0!==t&&(r=t.toUpperCase().split(" ")),$.each(r,function(e,s){if(""!==s){var a=s.replace(",","").replace(/[\r\n]+/g,"");return o.push(a)}}),-1!==o.indexOf(e))return a.push(s)}),t[e]=a}),t){var c=_.sortBy(t[o],[function(e){return e.score}]),n=_.groupBy(c,"metaData.stencilsCourseClassification");for(var i in n)for(var u in $('.dropDownBlock[data-subject-area="'+o+'"]').find(".dropDownSummary ul").append("<h3>"+i+"</h3>"),n[i]){var l=n[i][u].metaData.stencilsCourseTitle,p=n[i][u].metaData.stencilsCourseNumber,d=n[i][u].metaData.stencilsCourseCredit,h="https://search.ncl.ac.uk"+n[i][u].clickTrackingUrl,f=n[i][u].metaData.keywords,m=n[i][u].metaData.stencilsCourseTerm,v=n[i][u].metaData.stencilsCourseDesc,C=INTOformat(p,f,e);$('.dropDownBlock[data-subject-area="'+o+'"]').find(".dropDownSummary ul").append('<li><a href="Javascript:void(0);" class="dropDownHeading courseDropdown courseTitle">'+l+"<p>"+d+'</p><span class="toggle"></span></a><div class="courseExtra"><div class="courseExtraBox"><div class="courseExtraBox__left"><div class="courseBrief"><span class="ucasCode">UCAS code: <strong>'+C+'</strong></span><span class="courseYear">'+m+"</span><p>"+v+'</p><div class="courseInfo"><a href="'+h+'" class="cta">View full course information</a></div></div></div></div>')}}$(".courseTitle").click(function(){$(this).toggleClass("dropdownOpen"),$(this).is(".dropdownOpen")?$(this).next().slideDown():$(this).next().slideUp()})},displayCourseSort:function(s){var a=s.sort(function(e,s){return e.metaData.stencilsCourseTitle<s.metaData.stencilsCourseTitle?-1:e.metaData.stencilsCourseTitle>s.metaData.stencilsCourseTitle?1:0}),t="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");$.each(t,function(e){$("#a-z-display").append($('<li class="listletter listletter'+t[e]+'"><a class="letter'+t[e]+'">'+t[e]+"</a></li>"))});for(var r={},o=0;o<a.length;o++){var c=a[o].metaData.stencilsCourseTitle[0].toUpperCase();r[c]&&r[c].length>=0?r[c].push(a[o]):(r[c]=[],r[c].push(a[o]))}$.each(r,function(s,a){var t=".courseSearchResults__courseList";for(var r in $(t).append('<li class="courseSearchResults__letterSort"><h3 id="'+s+'">'+s+"</h3></li>"),a){var o=INTOformat(a[r].metaData.stencilsCourseNumber,a[r].metaData.keywords,e),c=void 0!==a[r].metaData.stencilsCourseCredit&&"undergraduate"===e?a[r].metaData.stencilsCourseCredit:"",n="https://search.ncl.ac.uk"+a[r].clickTrackingUrl;$(t).append('<li class="courseSearchResults__courseName">\n                    <a href="'.concat(n,'">').concat(a[r].metaData.stencilsCourseTitle,"</a> &nbsp; ").concat(c," ").concat(o,"\n                </li>"))}$(t).append("<li><a href='Javascript:void(0);' class='btn bk-to-top'>Back to top</a></li>")}),$(".courseSearchResults__letterSort h3").each(function(){$(".letter"+this.id).addClass("has__content")}),$(".listletter").click(function(){var e=$(this).children().text();$("html,body").animate({scrollTop:$("#"+e).offset().top},"slow")}),$(".bk-to-top").click(function(){$("html, body").animate({scrollTop:$(".courseSearchResults__alphabet-list").offset().top},"slow")})}};return{init:function(){s.displayCourseData()}}};function UGcourseSearch(e){"mbbs"!==e&&"MBBS"!==e||(e="mb bs");var s={query:e,collection:"neu-web-courses",num_ranks:300};$.ajax({url:"//search.ncl.ac.uk/s/search.json",type:"GET",data:s,dataType:"jsonp",beforeSend:function(){$(".searchCount").hide(),$(".courseSearchResults").hide(),$(".spinnerBox").show()},success:function(e){$(".spinnerBox").hide(),$(".searchCount").show(),$(".courseSearchResults").show();var s=$("#courseSearchResults > .row");$(".searchCount").remove(),$(s).empty(),$(s).show();var a=0;if(e.response.resultPacket.results.length>0){var t,r=[],o=[];t=e.response.resultPacket.results,$.each(t,function(e,s){void 0===s.metaData.stencilsCourseType&&""!==s.metaData.stencilsCourseType||("undergraduate"==s.metaData.stencilsCourseType?r.push(s):o.push(s))}),r.length>0?($.each(r,function(e,t){a++;var r=INTOformat(t.metaData.stencilsCourseNumber,t.metaData.keywords,"undergraduate");if(t.metaData.stencilsCourseCredit)var o=t.metaData.stencilsCourseCredit;else o="";if(t.metaData.stencilsCourseTerm)var c=t.metaData.stencilsCourseTerm;else c="";var n="https://search.ncl.ac.uk"+t.clickTrackingUrl,i="<div class='courseSearchResults__box'><h3><a href=\""+n+'">'+t.metaData.stencilsCourseTitle+"</a></h3><ul class='courseSearchResults__info'><li id='studyLevel'><span class='course_key'>Study Level:</span><span> "+o+" "+t.metaData.stencilsCourseType+"</span></li><li id='courseCode'><span class='course_key'>Course Code:</span>"+r+"</li><li id='courseLength'><span class='course_key'>Course Length:</span><span> "+c+" </span></li></ul><p>"+t.metaData.stencilsCourseDesc+"</p><div class='ctaContainer'><div class='ctaColumn'><a href='"+n+"' class='cta full'>View full course information</a></div></div></div></div>";$(s).append(i)}),$(".courseSearch").append('<p class="searchCount">We\'ve found <span>'+a+++"</span> courses related to your search criteria.</p>")):($.each(o,function(e,t){a++;var r=INTOformat(t.metaData.stencilsCourseNumber,"postgrad",courseType);if(t.metaData.stencilsCourseCredit)var o=t.metaData.stencilsCourseCredit;else o="";if(t.metaData.stencilsCourseMode)var c=t.metaData.stencilsCourseMode;else c="";var n="<div class='courseSearchResults__box'><h3><a href=\""+("https://search.ncl.ac.uk"+t.clickTrackingUrl)+'">'+t.metaData.stencilsCourseTitle+"</a></h3><ul class='courseSearchResults__info'><li id='studyLevel'><span class='course_key'>Study Level:</span><span> "+o+" "+t.metaData.stencilsCourseType+"</span></li><li id='courseCode'><span class='course_key'>Course Code:</span>"+r+"</li><li id='courseLength'><span class='course_key'>Course Length:</span><span> "+c+" </span></li></ul><p>"+t.metaData.stencilsCourseDesc+"</p></div>";$(s).append(n)}),$(".courseSearch").append('<section class="alert searchCount"><div class="row"><div class="alertInfo"><span class="alertIcon"></span><p class="alertText">Sorry, we don\'t offer undergraduate courses that match your search. Here\'s <span>'+a+++"</span> postgraduate course/s that matches your search criteria.</p></div></div></section>"))}else $(s).append("<div class='courseSuggestionBox'><p>Sorry, your search didn't match any of our courses.</p><h4>Search Suggestions: </h4><ul><li>Check your spelling</li><li>Try different words that mean the same thing</li></ul></div>"),$(s).append("<div class='courseSuggestionBox'><h4>Or you could find courses by: </h4><div><ul><li><a class='tabLinks' href='browse-subjects'>Browse Subjects</a></li><li><a class='tabLinks' href='a-z-courses'>See a list of courses A-Z</a></li></ul></div></div>")}})}function PGcourseSearch(e){var s={query:e,collection:"neu-web-courses",meta_stencilsCourseType_sand:"postgraduate",num_ranks:300};$.ajax({url:"//search.ncl.ac.uk/s/search.json",type:"GET",data:s,dataType:"jsonp",beforeSend:function(){$(".searchCount").hide(),$(".courseSearchResults").hide(),$(".spinnerBox").show()},success:function(e){$(".spinnerBox").hide(),$(".searchCount").show(),$(".courseSearchResults").show();var s=$("#courseSearchResults > .row");$(".searchCount").remove(),$(s).empty(),$(s).show();var a=0;if(e.response.resultPacket.results.length>0){var t,r=[];t=e.response.resultPacket.results,$.each(t,function(e,s){void 0===s.metaData.stencilsCourseType&&""!==s.metaData.stencilsCourseType||r.push(s)}),r.length>0&&($.each(r,function(e,t){a++;var r=t.metaData.stencilsCourseCredit?t.metaData.stencilsCourseCredit:"";if("Full time"===t.metaData.stencilsCourseMode);else if("Part time"===t.metaData.stencilsCourseMode);else if("Full and part time"===t.metaData.stencilsCourseMode||"Full/Part"===t.metaData.stencilsCourseMode);else;var o="https://search.ncl.ac.uk"+t.clickTrackingUrl,c="<div class='courseSearchResults__box'>\n                    <h3>\n                        <a href=\"".concat(o,'">').concat(t.metaData.stencilsCourseTitle,"</a>\n                    </h3>\n                    <ul class='courseSearchResults__info'>\n                        <li id='studyLevel'>\n                            <span class='course_key abs'>Study Level:</span><span>").concat(r," ").concat(t.metaData.stencilsCourseType,"</span>\n                        </li>\n                    </ul>\n                    <p>").concat(t.metaData.stencilsCourseDesc,"</p>\n                    <div class='ctaContainer'>\n                        <div class='ctaColumn'>\n                            <a href=\"").concat(o,"\" class='cta full'>View full course information</a>\n                        </div>\n                    </div>\n                </div>");$(s).append(c)}),$(".courseSearch").append('<p class="searchCount">We\'ve found <span>'+a+++"</span> courses related to your search criteria.</p>"))}else $(s).append("<div class='courseSuggestionBox'>\n                <p>Sorry, your search didn't match any of our courses.</p>\n                <h4>Search Suggestions: </h4>\n                <ul>\n                    <li>Check your spelling</li>\n                    <li>Try different words that mean the same thing</li>\n                </ul>\n            </div>")}})}function simplfiedSearch(){$(".tabLinks").remove(),$(".tabContent").removeClass("open"),$("#search-courses").remove(),$("#browser-subjects").remove(),$("#a-z-courses").addClass("open")}function formatTrackUrl(e){return"https://search.ncl.ac.uk"+e.replace("neu-web-courses","neu-meta")}function titleCase(e){var s=[];return s.push(e.charAt(0).toUpperCase()+e.slice(1)),s.join(" ")}function INTOformat(e,s,a){if("undergraduate"===a)if(null!=e){if("INTO"==e)var t='<span class="into__icon"></span>';else if(null!=_typeof(s))t="<span>"+e+"</span>"}else t="<span>N/A</span>";else t="";return t}function getUrlVars(){for(var e,s=[],a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),t=0;t<a.length;t++)e=a[t].split("="),s.push(e[0]),s[e[0]]=e[1];return s}$(document).ready(function(){$("#undergraduateQueryForm").submit(function(e){e.preventDefault();var s=$("#searchQuery").val();s.length>0&&UGcourseSearch(s)}),$("#postgraduateQueryForm").submit(function(e){e.preventDefault();var s=$("#searchQuery").val();s.length>0&&PGcourseSearch(s)}),$(".courseSearchResults__alphabet-list").hide(),$(".courseSearchResults__courseList").hide(),displayCourses().init(),$(".searchBoxQueryInput").focus(function(){$(this).data("placeholder",$(this).attr("placeholder")).attr("placeholder","")}).blur(function(){$(this).attr("placeholder",$(this).data("placeholder"))});var e=getUrlVars().q;void 0!==e&&e.length>0&&($(".searchQueryForm #searchQuery").val(decodeURI(e).replace(/\+/g," ")),$(".searchQueryForm input[name='searchSubmit']").trigger("click"))});