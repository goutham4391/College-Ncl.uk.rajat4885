$(document).ready(function(){reqWidget.academic.initialize(),reqWidget.language.initialize()});var reqWidget={utils:{showResults:function(containerId){$("#"+containerId+" .noResults").addClass("hidden"),$("#"+containerId+" .selectACountry").addClass("hidden"),$("#"+containerId+" .results").removeClass("hidden")},hideResults:function(containerId){$("#"+containerId+" .results").addClass("hidden"),$("#"+containerId+" .noResults").removeClass("hidden"),$("#"+containerId+" .selectACountry").addClass("hidden")},showDefaultMessage:function(containerId){$("#"+containerId+" .noResults").addClass("hidden"),$("#"+containerId+" .selectACountry").removeClass("hidden"),$("#"+containerId+" .results").addClass("hidden")},initSelectDropdown:function(containerId,selectId){$("#"+selectId).select2({dropdownCssClass:"reqSelectDropdown",minimumResultsForSearch:-1}),$("#"+containerId+" .reqSelect").removeClass("hidden")},toggleLoadingIndicator:function(containerId,action){"hide"===action?$("#"+containerId+" .reqResults").removeClass("loading"):"show"===action&&$("#"+containerId+" .reqResults").addClass("loading")},getCourseTitle:function(){var courseTitle="";return $('meta[name="ncl_course_title"]').attr("content").length&&(courseTitle=encodeURI($('meta[name="ncl_course_title"]').attr("content").trim())),courseTitle}},academic:{id:"js-academicReq",selectId:"",initialize:function(){$("#"+reqWidget.academic.id).length&&(reqWidget.utils.toggleLoadingIndicator(reqWidget.academic.id,"show"),reqWidget.academic.selectId=$("#"+reqWidget.academic.id+" .reqSelect").attr("id"),reqWidget.academic.loadCountries(),$("#"+reqWidget.academic.selectId).on("change",function(){reqWidget.utils.toggleLoadingIndicator(reqWidget.academic.id,"show"),"selectCountry"!==$(this).val()?reqWidget.academic.loadAcademicRequirementData($(this).val()):(reqWidget.utils.toggleLoadingIndicator(reqWidget.academic.id,"hide"),reqWidget.utils.showDefaultMessage(reqWidget.academic.id))}))},loadCountries:function(){var endpoint="//includes.ncl.ac.uk/cmswebservices/pg/entryRequirements/ws.php?list";$.ajax({method:"GET",url:endpoint,dataType:"json",global:!1}).done(function(data){void 0!==data.country&&""!==data.country?reqWidget.academic.populateCountryDropdown(data.country):(reqWidget.utils.hideResults(reqWidget.academic.id),reqWidget.utils.toggleLoadingIndicator(reqWidget.academic.id,"hide"))}).fail(function(){reqWidget.utils.hideResults(reqWidget.academic.id),reqWidget.utils.toggleLoadingIndicator(reqWidget.academic.id,"hide")})},populateCountryDropdown:function(countries){$("#"+reqWidget.academic.selectId).append('<option value="selectCountry">Select a Country</option>'),countries.forEach(function(country){$("#"+reqWidget.academic.selectId).append('<option value="'+country+'">'+country+"</option>")}),reqWidget.utils.initSelectDropdown(reqWidget.academic.id,reqWidget.academic.selectId),reqWidget.academic.loadAcademicRequirementData($("#"+reqWidget.academic.selectId).val())},loadAcademicRequirementData:function(country){if(country.length){var endpoint="//includes.ncl.ac.uk/cmswebservices/pg/entryRequirements/ws.php",params={country:country};$.ajax({method:"GET",url:endpoint,data:params,dataType:"json",global:!1}).done(function(data){void 0!==data.equivalency&&""!==data.equivalency&&null!==data.equivalency?($("#"+reqWidget.academic.id+" .results").html(data.equivalency),reqWidget.utils.showResults(reqWidget.academic.id)):"selectCountry"!==$("#"+reqWidget.academic.selectId).val()?reqWidget.utils.hideResults(reqWidget.academic.id):(reqWidget.utils.toggleLoadingIndicator(reqWidget.academic.id,"hide"),reqWidget.utils.showDefaultMessage(reqWidget.academic.id)),reqWidget.utils.toggleLoadingIndicator(reqWidget.academic.id,"hide")}).fail(function(){reqWidget.utils.hideResults(reqWidget.academic.id),reqWidget.utils.toggleLoadingIndicator(reqWidget.academic.id,"hide")})}else reqWidget.utils.hideResults(reqWidget.academic.id),reqWidget.utils.toggleLoadingIndicator(reqWidget.academic.id,"hide")}},language:{id:"js-languageReq",selectId:"",initialize:function(){$("#"+reqWidget.language.id).length&&(reqWidget.utils.toggleLoadingIndicator(reqWidget.language.id,"show"),reqWidget.language.selectId=$("#"+reqWidget.language.id+" .reqSelect").attr("id"),reqWidget.language.loadLanguageRequirementData(reqWidget.utils.getCourseTitle()),reqWidget.utils.initSelectDropdown(reqWidget.language.id,reqWidget.language.selectId),$("#"+reqWidget.language.selectId).on("change",function(){reqWidget.language.switchCertification($("#"+reqWidget.language.selectId).val())}))},loadLanguageRequirementData:function(courseTitle){var endpoint="//includes.ncl.ac.uk/cmswebservices/pg/languageRequirements/ws.php?title="+courseTitle;$.ajax({method:"GET",url:endpoint,dataType:"json",global:!1}).done(function(data){if(0!==data.length&&data.band.length)for(var name in data)name.length&&("band"===name?$.isNumeric(data[name])&&(reqWidget.language.updateBandNumber(data[name]),$("#js-bandText").removeClass("hidden")):reqWidget.language.createCertificationText(name,data[name]))}).done(function(){reqWidget.language.switchCertification($("#"+reqWidget.language.selectId).val())}).fail(function(){reqWidget.language.switchCertification($("#"+reqWidget.language.selectId).val())})},updateBandNumber:function(bandNumber){bandNumber.length&&$("#js-bandNumber").text(bandNumber)},createCertificationText:function(certification,certificationText){certificationText.length&&$("#js-languageReqResults .results").append('<div class="text '+certification+' hidden"><p>'+certificationText+"</p></div>")},switchCertification:function(certification){certification.length&&$("."+certification).length?($("#"+reqWidget.language.id+" .results .text:not(."+certification+")").addClass("hidden"),reqWidget.utils.showResults(reqWidget.language.id),$("#"+reqWidget.language.id+" .results ."+certification).removeClass("hidden"),$("#"+reqWidget.language.id+" .lowerScore").removeClass("hidden")):($("#"+reqWidget.language.id+" .lowerScore").addClass("hidden"),reqWidget.utils.hideResults(reqWidget.language.id)),reqWidget.utils.toggleLoadingIndicator(reqWidget.language.id,"hide")}}};